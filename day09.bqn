⟨Split, ToNums⟩ ← •Import "bqn-libs/strings.bqn"

i←{(⊑ToNums𝕩)⋈⟨0‿1,0‿¯1,¯1‿0,1‿0⟩⊑˜"RLDU"⊐𝕨}´¨' 'Split¨•FLines"input09.txt"

F ← {
  l←⟨⟩ ⋄ P ← {l∾↩<⊢´𝕩⋄𝕩}(⊢+(××·∨´1<|)∘-)`
  (0‿0⥊⟜<˜1+𝕨){n‿d𝕊𝕩: d{P d⊸+⌾⊑𝕩}⍟n 𝕩}´⌽𝕩
  ≠⍷l
}
•Show F⟜i¨1‿9
