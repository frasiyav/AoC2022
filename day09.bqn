⟨Split, ToNums⟩ ← •Import "bqn-libs/strings.bqn"

i←{(⊑ToNums𝕩)⋈⟨0‿1,0‿¯1,¯1‿0,1‿0⟩⊑˜"RLDU"⊐𝕨}´¨' 'Split¨•FLines"input09.txt"

P ← ⊢+(××·∨´1<|)∘-
F ← {
  ⟨o,·‿s⟩←--`(⌊˝⋈⌈˝)+`>×´¨𝕩
  l←⟨⟩ ⋄ M ← {l∾↩s⊸×⊸+´¯1⊑𝕩}⊸⊢
  (𝕨+⟜1⊸⥊<o){n‿d𝕊𝕩: d{M P`d⊸+⌾⊑𝕩}⍟n 𝕩}´⌽𝕩
  ≠⍷l
}

•Show F⟜i¨1‿9
