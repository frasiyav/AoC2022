âŸ¨lf, Split, ToNumsâŸ© â† â€¢Import "bqn-libs/strings.bqn"
While â† {ğ•©{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}ğ•¨@}Â´

i â† ToNumsâš‡1 " -> "âŠ¸SplitÂ¨ â€¢file.Lines "input14.txt"

â€¢Show { # Part 1
  grid â† 0â¥ŠËœ3+-Â´maxâ€¿minâ†(âŒˆÂ´â‹ˆâŒŠÂ´)iâˆ¾âŠ¸âˆ¾<500â€¿0
  {grid 1Â¨âŒ¾((ğ•¨âŠ¸+Â¨â†•1+ğ•©-ğ•¨)âŠ¸âŠ‘)â†©}Â´âˆ˜âˆ§Ë˜âˆ¾2â†•Â¨i-âš‡1 min
  drop â† 500â€¿0-min
  oob â† 0â€¿0â‹ˆÂ¨1-Ëœâ‰¢grid
  InBounds â† âˆ§Â´âŸ2â‰ âŸœoob
  NotBlocked â† {Â¬gridâŠ‘Ëœğ•©}

  câ†0
  doneâ†0
  While {ğ•Š:Â¬done}â€¿{ğ•Š:
    c+â†©1
    Step â† { ğ•Šp:
      {
        Ã—â‰ mâ†/NotBlockedÂ¨ğ•©?
          InBoundsâ—¶{ğ•Š:doneâ†©1}â€¿Step m âŠ‘âŠ¸âŠ‘ ğ•©
      ;
        grid 1âŒ¾(pâŠ¸âŠ‘)â†©
      } âŸ¨0â€¿1,Â¯1â€¿1,1â€¿1âŸ©+âš‡1 ğ•©
    }
    Step drop
    c+â†©
  }
  c-1
}

â€¢Show { # Part 2
  wâ†1âŠ‘âŒˆÂ´âˆ¾i
  sâ†âŸ¨2Ã—w,0âŸ©+-Â´maxâ€¿minâ†(âŒˆÂ´â‹ˆâŒŠÂ´)iâˆ¾âŠ¸âˆ¾<500â€¿0
  grid â† 0â¥ŠËœ2+s
  {grid 1Â¨âŒ¾((ğ•¨âŠ¸+Â¨â†•1+ğ•©-ğ•¨)âŠ¸âŠ‘)â†©}Â´âˆ˜âˆ§Ë˜âˆ¾2â†•Â¨(iâˆ¾<2/âŸ¨500â€¿0âŸ©)-âš‡1 min-wâ€¿0
  +Â´â¥Š{ğ•©Â¬âŠ¸âˆ§âˆ¨Â´Ë˜3â†•(Â»âŠ¢â†‘Ëœ2+â‰ )ğ•¨}`âŒ¾(<Ë˜)â‰grid
}
