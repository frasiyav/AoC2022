âŸ¨lf, Split, ToNumsâŸ© â† â€¢Import "bqn-libs/strings.bqn"
While â† {ğ•©{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}ğ•¨@}Â´

i â† ToNumsâš‡1 " -> "âŠ¸SplitÂ¨ â€¢file.Lines "input14.txt"

grid â† 0â¥ŠËœÂ¬Â´Â·â€¿minâ†500â€¿0(âŒˆÂ´â‹ˆâŒŠÂ´)âˆ¾i
{grid 1Â¨âŒ¾((ğ•¨âŠ¸+Â¨â†•ğ•©Â¬ğ•¨)âŠ¸âŠ‘)â†©}Â´âˆ˜âˆ§Ë˜âˆ¾2â†•Â¨i-âš‡1 min
drop â† 500â€¿0-min

P1 â† { ğ•Š grid:
  OOB â† âˆ¨Â´1â‰ (0âˆ¾Ë˜â‰¢grid)â‹Ë˜âŠ¢
  câ†0 â‹„ doneâ†0
  While {ğ•Š:Â¬done}â€¿{ğ•Š:
    { Step ğ•©:
      Ã—â‰ mâ†Â¬âˆ˜âŠ‘âŸœgridâŠ¸/ğ•©+âš‡1âŸ¨0â€¿1,Â¯1â€¿1,1â€¿1âŸ©?
        OOBâ—¶Stepâ€¿{ğ•Š:doneâ†©1â‹„c} âŠ‘m
      ;
        c+â†©1 â‹„ grid 1âŒ¾(ğ•©âŠ¸âŠ‘)â†©
    } drop
  }
}

P2 â† { ğ•Š grid:
  grid 1âŒ¾(dropâŠ¸âŠ‘)â†©
  grid (â‰Â·Â»âŠ¢â†‘Ëœ2â€¿1+â‰¢)â†©
  grid (Â«âˆ¨Â»âˆ¨âŠ¢)âŠ¸âˆ§âŸœÂ¬`âŒ¾(<Ë˜)â†©

  eâ†âŠ‘âˆ˜/Ë˜0â€¿Â¯1âŠâ‰grid
  (+Â´â¥Šgrid)+Â´+âŸœ1âŠ¸Ã—âŠ¸Ã·âŸœ2 (âŠ‘â‰¢grid)-1+e
}

â€¢Show P1 grid
â€¢Show P2 grid
