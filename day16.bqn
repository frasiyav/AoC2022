âŸ¨Split, ToNumsâŸ© â† â€¢Import "bqn-libs/strings.bqn"
âŸ¨HashmapâŸ© â† â€¢Import "bqn-libs/hashmap.bqn"

[key,flow,c]â†â‰>{âŸ¨1âŠ‘ğ•©, âŠ‘ToNums 4âŠ‘ğ•©, 2â†‘Â¨9â†“ğ•©âŸ©}Â¨' 'SplitÂ¨â€¢file.Lines"input16.txt"

adj â† >(â‰ key)â†‘Â¨(/â¼keyâŠ¸âŠ)Â¨c
paths â† 1+{ğ•©ğ•ŠâŸâ‰¢âŒŠËâˆ˜+â‰1â€¿âˆËœâŠ¸âŒŠğ•©}âˆâ‹†Â¬adj
start â† key(âŠ£â‰ âŠ¸â†‘Â·/â¼âŠâŸœâ‹ˆ)"AA"

NZ â† (startâˆ¨0â‰ flow)âŠ¸/
paths NZË˜âˆ˜NZâ†©
flow NZâ†©
start â†© âŠ‘/initâ†NZ start

memo â† HashmapËœâŸ¨âŸ©
MSet â† {ğ•¨ memo.Set ğ•© â‹„ ğ•©}

Search â† {
  memo.Has ğ•©? memo.Get ğ•©;
  ğ•Š openâ€¿currâ€¿t:
    ğ•©âŠ¸MSet âŒˆÂ´{
      (ğ•©âŠ‘open) âˆ¨ ğ•©â‰¡curr? 0;
      0 < nt â† t - currâ€¿ğ•©âŠ‘paths?
        (ntÃ—ğ•©âŠ‘flow) + Search âŸ¨1âŒ¾(ğ•©âŠ¸âŠ‘)open, ğ•©, ntâŸ©
      ; 0
    }Â¨â†•â‰ paths
}

â€¢Show Search âŸ¨init, start, 30âŸ©

bc â† âˆ˜â€¿16â¥ŠâŸ¨16â€¿'c',1âŸ©â€¢bit._Cast@+â†•2â‹†â‰ paths
â€¢Show âŒˆÂ´+â—‹{SearchâŸ¨initâˆ¨ğ•©, start, 26âŸ©}âŸœÂ¬Ë˜bc
