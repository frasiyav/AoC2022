âŸ¨lf, Split, ToNumsâŸ© â† â€¢Import "bqn-libs/strings.bqn"
N â† âŠ‘ToNums

i â† (' 'SplitÂ¨1â†“lf Split âŠ¢)Â¨(lfâˆ¾lf)Split Â¯1â†“â€¢file.Chars "input11.txt"

Monkey â† {ğ•Š aâ€¿bâ€¿câ€¿dâ€¿e:
  ctâ‡0
  items â† NÂ¨4â†“a
  testâ€¿tâ€¿f â‡ NÂ¨Â¯1âŠ‘Â¨câ€¿dâ€¿e
  op â† {"*":Ã—;"+":+}âŠ¸{ğ•âŠ¸ğ•}âŸœ{"old":âŠ¢;Nğ•©}Â´Â¯2â†‘b

  Catch â‡ {itemsâˆ¾â†©ğ•©}
  _Turn â‡ {
    new â† ğ”½ Op items
    ct+â†©â‰ items â‹„ itemsâ†©âŸ¨âŸ©
    (tâ€¿fâŠğ•©){ğ•¨.Catchğ•©/new}Â¨ â‹ˆâŸœÂ¬ 0=test|new
  }
}

_Round â† {F _ğ•£ m: {F ğ•©._Turn m}Â¨m â‹„ m}
MB â† Ã—Â´2â†‘Â·âˆ¨{ğ•©.ct}Â¨

â€¢Show MB (âŒŠÃ·âŸœ3)_RoundâŸ20 MonkeyÂ¨i
â€¢Show MB {(â€¢math.LCMÂ´{ğ•©.test}Â¨ğ•©)âŠ¸|_RoundâŸ10000 ğ•©}MonkeyÂ¨i




{ # Regex parsing example
pcre2 â† â€¢Import "../bqn-pcre2/pcre2.bqn"
re â† {extendedâ‡1} pcre2.Compile "
\Q  Starting items: \E       (\d+(?:,\ \d+)*) \n
\Q  Operation: new = old \E     ([+*])\ (\w+) \n
\Q  Test: divisible by \E               (\d+) \n
\Q    If true: throw to monkey \E       (\d+) \n
\Q    If false: throw to monkey \E      (\d+) \n
"
â€¢Show â‰â‰i â† 1â†“Â¨re.MatchAll â€¢file.Chars "input11.txt"
i â†© ToNumsâŒ¾âŠ‘Â¨{"*":Ã—;"+":+;"old":âŠ¢;Nğ•©}Â¨âŒ¾(1âŠ¸â†“)Â¨i

Monkey â† {
  itemsâ€¿aâ€¿bâ€¿dâ€¿tâ€¿fâ‡ğ•© â‹„ ctâ‡0
  Catch â‡ {itemsâˆ¾â†©ğ•©}
  _Turn â‡ {
    new â† ğ”½ AâŸœB items
    ct+â†©â‰ items â‹„ itemsâ†©âŸ¨âŸ©
    (tâ€¿fâŠğ•©){ğ•¨.Catch ğ•©/new}Â¨ â‹ˆâŸœÂ¬ 0=d|new
  }
}

_Round â† {F _ğ•£ m: {F ğ•©._Turn m}Â¨m â‹„ m}
MB â† Ã—Â´2â†‘Â·âˆ¨{ğ•©.ct}Â¨

â€¢Show MB (âŒŠÃ·âŸœ3)_RoundâŸ20 MonkeyÂ¨i
â€¢Show MB {(â€¢math.LCMÂ´{ğ•©.d}Â¨ğ•©)âŠ¸|_RoundâŸ10000 ğ•©}MonkeyÂ¨i
}
