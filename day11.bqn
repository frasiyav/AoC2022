âŸ¨lf, Split, ToNumsâŸ© â† â€¢Import "bqn-libs/strings.bqn"
N â† âŠ‘ToNums

i â† (' 'SplitÂ¨lf Split âŠ¢)Â¨(lfâˆ¾lf)Split Â¯1â†“â€¢file.Chars "input11.txt"

Monkey â† {ğ•Š Â·â€¿aâ€¿bâ€¿câ€¿dâ€¿e:
  ctâ‡0 â‹„ items â† NÂ¨4â†“a
  testâ€¿tâ€¿f â‡ (N Â¯1âŠ‘âŠ¢)Â¨câ€¿dâ€¿e
  op â† {"*":Ã—;"+":+}âŠ¸{ğ•âŠ¸ğ•}âŸœ{ğ•Š"old":âŠ¢;Nğ•©}Â´Â¯2â†‘b
  _Inspect â† {ct+â†©â‰ ğ•© â‹„ {Â·:itemsâ†©âŸ¨âŸ©}âŠ¸âŠ¢ ğ”½ OpÂ¨ğ•©} 
  Catch â‡ {itemsâˆ¾â†©ğ•©}
  Turn â‡ {(tâ€¿fâŠğ•¨){ğ•¨.Catchğ•©/new}Â¨â‹ˆâŸœÂ¬(0=test|âŠ¢)newâ†ğ•_Inspect items}
}

_Round â† {ğ•—{mğ•©.Turnğ•—}Â¨mâ†ğ•©â‹„m}
P1 â† (âŒŠÃ·âŸœ3)_RoundâŸ20 MonkeyÂ¨
P2 â† (â€¢math.LCMÂ´{ğ•©.test}Â¨)âŠ¸{ğ•¨âŠ¸|_RoundâŸ10000 ğ•©} MonkeyÂ¨
â€¢Show (Ã—Â´2â†‘Â·âˆ¨{ğ•©.ct}Â¨)Â¨(P1â‹ˆP2)i
